pipeline:
  build:
    image: alpine:3.6
    commands:
      - apk add --no-cache maven openjdk8 git curl wget
      - apk --update add tar
      - git clone https://github.com/glyptodon/guacamole-client
      - cd guacamole-client/guacamole-docker/bin
      - ./build-guacamole.sh ../.. .
  
  docker:
    image: plugins/docker
    repo: lowet84/guacamole:alpine
    secrets: [ docker_username, docker_password ]
    tags: latest
    when:
      branch: master